
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tutorials and guides for the MAGICC lab">
      
      
        <meta name="author" content="MAGICC lab members">
      
      
        <link rel="canonical" href="https://byu-magicc.github.io/wiki/ros2_tutorials/c%2B%2B_node_class/">
      
      
        <link rel="prev" href="../packages/">
      
      
        <link rel="next" href="../python_node_class/">
      
      
      <link rel="icon" href="../../assets/favicon-16x16.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Lesson 12a: Nodes Based on Classes (C++) - MAGICC Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nodes-based-on-classes-c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MAGICC Wiki" class="md-header__button md-logo" aria-label="MAGICC Wiki" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MAGICC Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lesson 12a: Nodes Based on Classes (C++)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../safety/" class="md-tabs__link">
        
  
  
    
  
  Safety

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../intro/" class="md-tabs__link">
          
  
  
  ROS2 Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../gazebo_tutorials/overview/" class="md-tabs__link">
          
  
  
  Gazebo Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../control_tutorials/overview/" class="md-tabs__link">
          
  
  
  Control Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../computers/pixhawk/" class="md-tabs__link">
          
  
  
  Hardware Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../sw_guides/ceres_solver/" class="md-tabs__link">
          
  
  
  Software Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../administration/getting_started_in_research/" class="md-tabs__link">
          
  
  
  Administration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../computers/systemd/" class="md-tabs__link">
          
  
  
  Misc

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MAGICC Wiki" class="md-nav__button md-logo" aria-label="MAGICC Wiki" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    MAGICC Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Safety
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    ROS2 Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ROS2 Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 1: Introduction to ROS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../starting_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 2: Starting Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 3: Getting Info About Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/1_L1-3_node_running/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 1: Running Nodes: Listener and Talker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/2_L1-3_turtlesim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 2: Turtlesim Assignment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 4: The ROS Filesystem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../launch_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 5: Launch Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/3_L4-5_creating_launch_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 3: Launch Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/4_L4-5_explaining_launch_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 4: Launch Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rostopic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 6: ROS2 Topics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/5_L6_nodes_topics_and_messages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 5: Nodes, Topics and Messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topic_remapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 7: Topic Remapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 8: ROS2 Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adv_launch_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 9: Additional Launch File Syntax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/6_L7-9_more_launch_file1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 6: More Launch File Practice 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/7_L7-9_more_launch_file2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 7: More Launch File Practice 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/8_L7-9_launch_file_advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 8: Creating a Launch File with Parameters and Topic Remapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/9_L7-L9_edit_node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 9: diting Teleop Twist Joy Node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../creating_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 10: Creating Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 11: Packages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lesson 12a: Nodes Based on Classes (C++)
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_node_class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 12b: Nodes Based on Classes (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/10_L10-12_draw_a_star/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 10: Draw a Star
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/11_L10-12_fuel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 11: Display/Publish Fuel Remaining
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignments/12_L10-12_out_of_fuel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 12: Stop Turtlesim When Fuel Runs Out
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiple_machines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 13: ROS2 on Multiple Machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 14: Others
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mocap/mocap_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 15: Motion Capture Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Gazebo Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Gazebo Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 0: Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/make_a_robot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 1: Make a Robot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/adding_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 2: Adding Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/assignments/make_a_multirotor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 1: Make a Multirotor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/assignments/make_a_fixed_wing_mav/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 2: Make a Fixed Wing MAV
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/interfacing_with_gazebo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 3: Interfacing with Gazebo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/assignments/flying_your_mav/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 3: Flying Your MAV
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/make_a_world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 4: Make a World
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/assignments/make_your_own_world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 4: Make Your Own World
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gazebo_tutorials/adding_an_image_to_the_ground_plane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 5: Adding an Image to the Ground Plane
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Control Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Control Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 0: Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/p_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 1: P Controller
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/assignments/p_turtle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 0: P Controller with TurtleSim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/pd_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 2: PD Controller
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/assignments/pd_turtle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 1: PD Controller with TurtleSim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/pid_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 3: PID Controller
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../control_tutorials/assignments/pid_turtle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment 2: PID Controller with TurtleSim
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hardware Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Hardware Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../computers/pixhawk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pixhawk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../computers/jetson/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NVIDIA Jetson TX2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/rospberry_pi_zero/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Raspberry Pi Zero W
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CUDA and GPGPUs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/ubiquiti/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ubiquiti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/ublox_f9p/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RTK GPS: ZED-F9P
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/c94_m8p/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RTK GPS: C94-M8P
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/asus_xtion_pro_live/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ASUS Xtion Pro Live
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/intel_rs_d400/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intel RealSense D4xx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/lipo_batts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lithium-Polymer Batteries (Li-Po)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/charging_lipo_batts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Battery Charger Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hw_guides/design_propulsion_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Designing a Propulsion System
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Software Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Software Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/ceres_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Ceres Solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/install_cuda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing CUDA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/opencv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenCV with CUDA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Know-how
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/mocap_room_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mocap Room Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/ublox_read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UBLOX_read Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/airsim_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Airsim Quickstart Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/airsim_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Airsim Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sw_guides/vtol_airsim_qs_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VTOL AirSim Quickstart Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Administration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/getting_started_in_research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started with Research
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/new_member_tips/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New Lab-member Tips
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/conference_room_schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conference Room Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../computers/systemd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Startup Scripts with systemd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../computers/headless/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Headless vs Graphical Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/caedm_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CAEDM Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/debugging_ros_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debugging ROS Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/env_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/qt_creator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qt Creator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/ros_command_cheat_sheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ROS Command Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/setting_up_ssh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting Up ssh
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/syncing_time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Syncing Time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/using_git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/using_vim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Vim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/vpn_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPN Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/byu-magicc/wiki/edit/main/docs/ros2_tutorials/c++_node_class.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="nodes-based-on-classes-c">Nodes Based on Classes (C++)<a class="headerlink" href="#nodes-based-on-classes-c" title="Permanent link">&para;</a></h1>
<h1 id="classes">Classes<a class="headerlink" href="#classes" title="Permanent link">&para;</a></h1>
<p>If you have taken CS 142, you'll remember C++ classes. If you haven't or you have and you're totally lost, then you should probably brush up on your C++.  <a href="https://www.cplusplus.com/doc/tutorial/">This</a> is a pretty good tutorial that should help you get up to speed on C++ programming.</p>
<p>In short, we use classes because they are convenient.  They may not seem so convenient at first, but being able to split up your code into different files makes it a lot easier, and classes make it easy to store variables in between function calls, and limit the scope of functions.  You could just program every node in one giant main cpp file, but that eventually becomes unreasonable.</p>
<p>In the MAGICC lab, we generally organize our nodes as follows:</p>
<p><img alt="C++ Node Example" src="../figures/node_class/node_class_example_cpp.png" /></p>
<p>We have the <code>CMakelists.txt</code> file that you're used to seeing, the <code>package.xml</code>, but then we make an include folder with the <code>.hpp</code> file inside, the <code>.cpp</code> file that implements the class functions, and then the main file, which is more of a ROS2 daemon than anything (spins up the node, and connects it to ROS2).  Almost all of the actual work is done in the class <code>.cpp</code> file.</p>
<h1 id="example-moving-sensor-package">Example: Moving Sensor Package<a class="headerlink" href="#example-moving-sensor-package" title="Permanent link">&para;</a></h1>
<p>The picture above has the general outline of what is in each node, but here's an example node which listens to the turtlesim pose message and publishes a boolean flag of whether or not it is moving. The "moving_sensor" package is in the <code>ros2-tutorials</code> git repo. "Bool.msg" in "bool_interfaces/msg" is a message type I created which is simply "bool data". If you're interested in creating custom msg and srv files, see <a href="https://docs.ros.org/en/jazzy/Tutorials/Beginner-Client-Libraries/Custom-ROS2-Interfaces.html">here</a>.</p>
<p>The file structure appears as follows:</p>
<div class="highlight"><pre><span></span><code>moving_sensor
├── CMakeLists.txt
├── package.xml
├── include
│   ├── moving_sensor
│   │   └── moving_sensor.hpp
├── src
│   ├── moving_sensor.cpp
│   └── moving_sensor_node.cpp
</code></pre></div>
<h3 id="cmakeliststxt">CMakeLists.txt<a class="headerlink" href="#cmakeliststxt" title="Permanent link">&para;</a></h3>
<p>Let's look at the <code>CMakeLists.txt</code> of this package.  I've highlighted what each line does in this file below</p>
<div class="highlight"><pre><span></span><code><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.8</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">moving_sensor</span><span class="p">)</span><span class="w">  </span><span class="c"># &lt;-- this is the project name, should match in the package.xml</span>

<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span><span class="w">        </span><span class="c"># This goes out and finds the packages required for our moving sensor.</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">turtlesim</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span><span class="w">          </span><span class="c"># We need turtlesim because we are listening to turtlesim/msg/Pose messages.</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">bool_interfaces</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span><span class="w">    </span><span class="c"># We need bool_interfaces because we are publishing a bool_interfaces/msg/Bool.</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span><span class="w">             </span><span class="c"># Often, we need Eigen, tf, and other packages that we use in the node.</span>


<span class="nb">include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span><span class="w"> </span><span class="c"># This line makes sure the compiler looks in the include folder for our headers</span>
<span class="nb">include_directories</span><span class="p">(</span>
<span class="w">  </span><span class="o">${</span><span class="nv">ament_INCLUDE_DIRS</span><span class="o">}</span><span class="w">      </span><span class="c"># This line adds in the headers already added by ament.</span>
<span class="p">)</span>

<span class="c">## Declare a cpp executable</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">moving_sensor_node</span><span class="w"> </span><span class="s">src/moving_sensor_node.cpp</span><span class="w"> </span><span class="s">src/moving_sensor.cpp</span><span class="p">)</span>
<span class="c"># These lines create the executable (node).  You can make more than</span>
<span class="c"># one node per package, each node should have only one main() function.</span>
<span class="c"># We explicitly tell it which .cpp files to compile into that node</span>

<span class="c">## Add ament target dependencies of the executable/library</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">moving_sensor_node</span><span class="w"> </span><span class="s">rclcpp</span><span class="w"> </span><span class="s">turtlesim</span><span class="w"> </span><span class="s">bool_interfaces</span><span class="p">)</span>
<span class="c"># This ensures that the turtlesim and bool_interfaces packages, including their messages, are properly set up before your node is built.</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">  </span><span class="s">moving_sensor_node</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>

<span class="nb">ament_package</span><span class="p">()</span>
</code></pre></div>
<h3 id="packagexml">package.xml<a class="headerlink" href="#packagexml" title="Permanent link">&para;</a></h3>
<p>Let's look now at the <code>package.xml</code>.  This file is by far the easiest of the bunch it's pretty much self-explanatory</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>

<span class="nt">&lt;package</span><span class="w"> </span><span class="na">format=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;name&gt;</span>moving_sensor<span class="nt">&lt;/name&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
<span class="w">  </span><span class="nt">&lt;description&gt;</span>The<span class="w"> </span>moving_sensor<span class="w"> </span>package<span class="nt">&lt;/description&gt;</span>

<span class="w">  </span><span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;hebeshen@byu.edu&quot;</span><span class="nt">&gt;</span>hebeshen<span class="nt">&lt;/maintainer&gt;</span>

<span class="w">  </span><span class="nt">&lt;license&gt;</span>Apache-2.0<span class="nt">&lt;/license&gt;</span>

<span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;depend&gt;</span>turtlesim<span class="nt">&lt;/depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;depend&gt;</span>bool_interfaces<span class="nt">&lt;/depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>

<span class="w">  </span><span class="nt">&lt;export&gt;</span>
<span class="w">    </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="w">  </span><span class="nt">&lt;/export&gt;</span>

<span class="nt">&lt;/package&gt;</span>
</code></pre></div>
<h3 id="moving_sensorhpp">moving_sensor.hpp<a class="headerlink" href="#moving_sensorhpp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#ifndef MOVING_SENSOR_HPP</span>
<span class="cp">#define MOVING_SENSOR_HPP</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;turtlesim/msg/pose.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;bool_interfaces/msg/bool.hpp&quot;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">moving_sensor</span>
<span class="p">{</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MovingSensor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MovingSensor</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="c1">//***************** PUBLISHERS AND SUBSCRIBERS ***************//</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">pose_subscriber_</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// will end up getting hooked up to the callback for the Pose message</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">bool_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Bool</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">bool_publisher_</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// will publish the flag to ROS2</span>

<span class="w">  </span><span class="c1">//***************** PARAMETERS ***************//</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">threshold_</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// a parameter we get from the ROS2 server, in this case the value below which</span>
<span class="w">  </span><span class="c1">// we consider the turtle as not moving.  This is basically a class variable</span>
<span class="w">  </span><span class="c1">// at this point,</span>

<span class="w">  </span><span class="c1">//***************** STATE VARIABLES ***************//</span>
<span class="w">  </span><span class="c1">// in this node, we don&#39;t have any variables.  Often though, we need to remember</span>
<span class="w">  </span><span class="c1">// things between loops, so we could create variables here to hold those values</span>

<span class="w">  </span><span class="c1">//***************** CALLBACKS ***************//</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">poseCallback</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// this function will get called every time ROS2 &quot;spins&quot;</span>
<span class="w">  </span><span class="c1">// and there is a Pose message in the queue.  More on this</span>
<span class="w">  </span><span class="c1">// later</span>

<span class="w">  </span><span class="c1">//***************** FUNCTIONS ***************//</span>
<span class="w">  </span><span class="c1">// Also, in this node, we don&#39;t have any &quot;helper&quot; functions.  These are useful</span>
<span class="w">  </span><span class="c1">// if you need to break up the work in the node into different functions</span>
<span class="p">};</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace moving_sensor</span>

<span class="cp">#endif </span><span class="c1">// MOVING_SENSOR_HPP</span>
</code></pre></div>
<h3 id="moving_sensorcpp">moving_sensor.cpp<a class="headerlink" href="#moving_sensorcpp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;moving_sensor/moving_sensor.hpp&quot;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">moving_sensor</span>
<span class="p">{</span>

<span class="n">MovingSensor</span><span class="o">::</span><span class="n">MovingSensor</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="s">&quot;moving_sensor_node&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">//***************** RETRIEVE PARAMS ***************//</span>
<span class="w">  </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">declare_parameter</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;threshold&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0001</span><span class="p">);</span>
<span class="w">  </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_parameter</span><span class="p">(</span><span class="s">&quot;threshold&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">threshold_</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// This will pull the &quot;threshold&quot; parameter from the 2 server, and store it in the threshold_ variable.</span>
<span class="w">  </span><span class="c1">// If no value is specified on the ROS2 param server, then the default value of 0.0001 will be applied.</span>

<span class="w">  </span><span class="c1">//***************** NODE HANDLES ***************//</span>
<span class="w">  </span><span class="n">pose_subscriber_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;turtle1/pose&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MovingSensor</span><span class="o">::</span><span class="n">poseCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">)</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="c1">// This connects the poseCallback function with the reception of a Pose message on the &quot;turtle1/pose&quot; topic</span>
<span class="w">  </span><span class="c1">// ROS2 will essentially call the poseCallback function every time it receives a message on that topic.</span>
<span class="w">  </span><span class="c1">// the &quot;1&quot; indicates the length of the queue to hold messages before tossing them.  In this case, our callback</span>
<span class="w">  </span><span class="c1">// function is so fast that 1 is sufficient.</span>

<span class="w">  </span><span class="n">bool_publisher_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">bool_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Bool</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;is_moving&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// This connects a std_msgs::Bool message on the &quot;is_moving&quot; topic.  The 1 also indicates the length of the queue</span>
<span class="w">  </span><span class="c1">// before tossing messages.  Publishers are generally so fast that 1 almost always works.</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">MovingSensor</span><span class="o">::</span><span class="n">poseCallback</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">turtlesim</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span>
<span class="c1">// This function runs every time we get a turtlesim::Pose message on the &quot;turtle1/pose&quot; topic.</span>
<span class="c1">// We generally use the const &lt;message&gt;ConstPtr &amp;msg syntax to prevent our node from accidentally</span>
<span class="c1">// changing the message, in the case that another node is also listening to it.</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">bool_interfaces</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Bool</span><span class="w"> </span><span class="n">out_flag</span><span class="p">;</span><span class="w">  </span><span class="c1">// create a new message to store the result of our check in</span>
<span class="w">  </span><span class="n">out_flag</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">linear_velocity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">threshold_</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// figure out if our velocity is more than the threshold and save the result in our new message</span>

<span class="w">  </span><span class="c1">// publish the message to ROS2</span>
<span class="w">  </span><span class="n">bool_publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">out_flag</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace moving_sensor</span>
</code></pre></div>
<h3 id="moving_sensor_nodecpp">moving_sensor_node.cpp<a class="headerlink" href="#moving_sensor_nodecpp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;moving_sensor/moving_sensor.hpp&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">moving_sensor</span><span class="o">::</span><span class="n">MovingSensor</span><span class="o">&gt;</span><span class="p">());</span>
<span class="w">  </span><span class="c1">// instatiate our class object and check for new messages and call the callback if we get one</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>